// packages
package itt.t00154755.mouseserver;

// imports
import java.awt.AWTException;
import java.awt.MouseInfo;
import java.awt.Point;
import java.awt.Robot;

/**
 * 
 * @author Christopher Donovan
 * 
 */
public class CursorRobot
{
	private static final String	TAG	= "Server Communication Thread";
	private Robot				robot;
	private String				acceloData;
	private int					moveX;
	private int					moveY;
	private int					startX;
	private int					startY;

	public CursorRobot ( String acceloData )
	{
		this.acceloData = acceloData;
		initCursorRobot();

	}

	private void initCursorRobot( )
	{
		int[] convertedString = covertStringToIntArray(acceloData);
		this.moveX = convertedString[0];
		this.moveY = convertedString[1];

		moveTheMouseToNewPosition(moveX, moveY);
	}

	private void moveTheMouseToNewPosition( int moveX, int moveY )
	{
		try
		{
			robot = new Robot();

			Point startLocation = MouseInfo.getPointerInfo().getLocation();
			this.startX = startLocation.x;
			this.startY = startLocation.y;
			while ( true )
			{
				int moveToX = moveX + startX;
				int moveToY = moveY + startY;

				robot.mouseMove(moveToX, moveToY);
				try
				{
					Thread.sleep(100);
				} catch ( InterruptedException exc )
				{
					exc.printStackTrace();
				}
			}// end of loop

		} catch ( AWTException e1 )
		{
			e1.printStackTrace();
		}
	}

	private synchronized int[] covertStringToIntArray( String acceloData )
	{
		String delims = "[,]";
		String[] tokens = acceloData.split(delims);
		int[] data = new int[tokens.length];

		for ( int i = 0; i < tokens.length; i++ )
		{
			try
			{
				data[i] = Integer.parseInt(tokens[i]);
			} catch ( NumberFormatException nfe )
			{
				// print the error stack
				System.out.print(TAG + "\n");
				nfe.printStackTrace();
				nfe.getCause();
				System.exit(-1);
			}
		}
		return data;
	}

}// end of class

