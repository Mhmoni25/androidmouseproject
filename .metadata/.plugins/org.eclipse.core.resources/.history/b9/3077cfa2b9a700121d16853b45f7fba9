package itt.t00154755.mouseserver;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;


public class ServerCommsThread implements Runnable
{

	private final String TAG = "Server Communication Thread";
	private final InputStream inputStream; // client
	private CursorRobot cr = new CursorRobot();


	public ServerCommsThread( InputStream in )
	{
		System.out.println(TAG + "\n-constructor");
		inputStream = in;
	}


	@Override
	public void run()
	{

		BufferedReader bReader = null;
		bReader = new BufferedReader(new InputStreamReader(inputStream));

		// keep reading
		while ( true )
		{
			try
			{
				String lineRead = bReader.readLine();
				
				if (lineRead != null)
				{
					System.out.println(TAG + "\npassing data to the robot");
					sendDataToCursorRobot(lineRead);
				}else
				{
					System.out.println(TAG + "\nread inputStream was null passing a zero packet");
					lineRead = "0,0,0";
					sendDataToCursorRobot(lineRead);
				}
				
			}
			catch ( IOException e )
			{
				// print the error stack
				e.printStackTrace();
				e.getCause();
				System.out.println(TAG + "shutting down the server 2");
				System.exit(-1);
			}
		}
	}


	private void sendDataToCursorRobot( String dataIn )
	{
		System.out.println(TAG + " " + dataIn);	
		cr.dataFromServer(dataIn);
	}

}// end of Class
